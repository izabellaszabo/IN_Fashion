<% content_for :title do %>
Product Details
<% end %>

<% content_for :header do %>
<% end %>

<% content_for :content do %>
<div id="itemcont">
<div id="breadcrumbs">
  <ul>
    <li>
      <h4><%= link_to "Home", :action => 'home', :controller => :site %></h4>
    </li>
    <li>
      >
    </li>
    <li>
      <h4><%= link_to @product.Catagory.titlecase, :action => @product.Catagory, :controller => :products %></h4>
    </li>
    <li>
      >
    </li>
    <li>
      <h4><%= link_to @product.subcategory.titlecase, :action => 'subcategory', 
        :subcategory => @product.subcategory, :breadcrumbsCategory => @product.Catagory %>
      </h4>
    </li>
    <li>
      >
    </li>
  </ul>
</div>

<div id="item">

  <h2><%= @product.Title %></h2>
  
  <div id="itemimg">
    <%= image_tag @product.image_url %>
  </div>
  
  
   <%= form_for (@TempOrder)   do |f|  %>
   
   
   
  
  
  <div id="itemdesc">
    <h4 id="itemprice"><%= number_with_precision(@product.price, precision: 2) %></h4>
    <h4 id="itemprice"><%= f.label :price,number_with_precision(@product.price, precision:2) %>
    
    
    
    
    <div id="rating">
      <span>☆</span>
      <span>☆</span>
      <span>☆</span>
      <span>☆</span>
      <span>☆</span>
      <br/>
      <ul id="review">
        <li>
          <h4><a id="review_trigger" href="#reviews">View Reviews</a></h4> 
        </li>
        <li>
          ||
        </li>
        <li>
          <h4><%= link_to "Review this Product", new_review_path(:productid => @product.id) %></h4>
        </li>
      </ul>
    </div>

    <div id="desc">
      <%= @product.Description %>
      <br/>
      <br/>
      <%= @product.features %>
    </div>
    
    <div id="size">
        
        <%if (@product.Size == 'all') then %>
          <%= f.select :Size, [['xs','xs'],['s','s'],['m','m'],['l','l'],['xl','xl']] %>
        <%else if @product.Size == 'shoe'%>
          <%= f.select :Size, [['4','4'],['5','5'],['6','6'],['7','7'],['8','8'],['9','9'],['10','10']] %>
        <%else%>
          <%= f.select :Size, [['one','one']] %>
        <%end%>
       
      </select>
    </div>  
    
    <div id="color">
  
      <select class="dropdown">
        <option value="default">Choose a color...</option>
        <% colors = @product.Colour.split(' ') %>
        <% colors.each_with_index do |color, index| %>
          <option value="<%= colors[index].strip %>"><%= colors[index].strip.titlecase %></option>
        <% end %>
        
      </select>
    </div>
    
    <div id="quantity"> 
      <%= f.number_field :Quantity,:placeholder => "Quantity",:min => 1, :max => 10%>
    </div>
    
    <div id="itemaddtocart">
      <!-- Color and Size have to be validated before added to cart? -->
      <h4><a href="#">Add to Cart</a></h4>
      
      
      
      <h4><%= f.submit "Add todo", class: "btn btn-primary" %></h4>
      <%end%>
      
      <%= tag "input", { "type" => "button", "value" => "Add to Cart", "onclick" => "addToCart(#{@product.price},#{@product.id})" } %>
      <%= tag "input", { "type" => "button", "value" => "List", "onclick" => "window.location.replace('../viewcart')" } %>
      <%= tag "input", { "type" => "button", "value" => "Clear Details(Will be removed)","onclick" => "cleardetails()" } %>
    </div>
  </div>

</div>

<div id="recommended">
 <h3 id="recommendedh3">Recommended for you</h3>
 <table id="productsTable">
    <col width="23%" />
    <col width="23%" />
    <col width="23%" />
    <col width="23%" />
 
 <% @recommended.each_with_index do |product, index| %>
  <% if index % 4 == 0 %>
   <tr>
  <% end %>
   <td>
    <div class="eachproduct">
     <%= link_to image_tag(product.image_url, :class => "productsimg"), product %>
     <h3 class="title"><%= link_to product.Title, product %></h3>
    </div>
   </td>
   <% if index % 4 == 3 %>
    </tr>
   <% end %>
 <% end %>
 </table>
</div>

<div id="reviews" style="display:none;">
		<header class="popupHeader" style="height: auto;">
			<div class="header_title">Reviews</div>
			<div class="modal_close">Close</div>
		</header>
		<section class="reviewshowBody">
			<div id="viewreviews">
				<% if @reviews.length != 0 %>
				  <% @reviews.each_with_index do |review, index| %>
				  <% if index % 2 == 0 %>
				    <div id="reviewsWhite">
				  <% else %>
				    <div id="reviewsGrey">
				  <% end %>
              <div id="reviewRating">
    				    <%= "4/5" %>
    				  </div>
    				  <div id="reviewSummary">
    				    <%= review.summary %>
    				  </div>
    				  <div id="reviewDate">
    				    <%= review.Date.strftime("%Y-%b-%d") %>
    				  </div>
    				  <div id="reviewBy">
    				    <div style="font-family: 'Cabin', Helvetica, Arial, sans-serif; width: 20px; float: left;">By</div>
    				    <% user = User.find_by(id: session[:user_id]) %>
    				    <%= user.name + " " + user.lastname %>
    				  </div>
    				  <div id="reviewComment">
    				    <%= review.Comment %>
    				  </div>
  				  </div>
				  <% end %>
				  <div id="writereview">
				    Write your own Review <%= link_to "here", new_review_path(:productid => @product.id), {:class => "signup", :style => "color: #761f31"} %>.
				  </div>
  				<% else %>
    				<p>
    				  This product hasn't been reviewed yet.
    				</p>
    				<p>
    					Be the first to review this product <%= link_to "Here", new_review_path(:productid => @product.id), {:class => "signup"} %>!
    				</p>
  				<% end %>
  			</div>
  		</div>
  	</section>
</div>
	<script type="text/javascript">
	  $("#review_trigger").leanModal({top : 100, overlay : 0.6, closeButton: ".modal_close" });
	
  	function getNewRating() {
  	  
  	}
  	
	</script>
</div>

<% end %>